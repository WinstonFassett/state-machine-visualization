(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{337:function(t,e,a){"use strict";a.r(e),a.d(e,"diagram",function(){return u});var i=a(297),n=a(2),r=a(259),d=a(257),s=a(250);a(60),a(61),a(59),a(26);const o={},c=(t,e)=>{o[t]=e},p=(t,e)=>{const a=t.append("text").attr("x",2*Object(s.p)().state.padding).attr("y",Object(s.p)().state.textHeight+1.3*Object(s.p)().state.padding).attr("font-size",Object(s.p)().state.fontSize).attr("class","state-title").text(e.descriptions[0]).node().getBBox(),i=a.height,n=t.append("text").attr("x",Object(s.p)().state.padding).attr("y",i+.4*Object(s.p)().state.padding+Object(s.p)().state.dividerMargin+Object(s.p)().state.textHeight).attr("class","state-description");let r=!0,d=!0;e.descriptions.forEach(function(t){r||(!function(t,e,a){const i=t.append("tspan").attr("x",2*Object(s.p)().state.padding).text(e);a||i.attr("dy",Object(s.p)().state.textHeight)}(n,t,d),d=!1),r=!1});const o=t.append("line").attr("x1",Object(s.p)().state.padding).attr("y1",Object(s.p)().state.padding+i+Object(s.p)().state.dividerMargin/2).attr("y2",Object(s.p)().state.padding+i+Object(s.p)().state.dividerMargin/2).attr("class","descr-divider"),c=n.node().getBBox(),p=Math.max(c.width,a.width);return o.attr("x2",p+3*Object(s.p)().state.padding),t.insert("rect",":first-child").attr("x",Object(s.p)().state.padding).attr("y",Object(s.p)().state.padding).attr("width",p+2*Object(s.p)().state.padding).attr("height",c.height+i+2*Object(s.p)().state.padding).attr("rx",Object(s.p)().state.radius),t},g=(t,e,a)=>{const i=Object(s.p)().state.padding,n=2*Object(s.p)().state.padding,r=t.node().getBBox(),d=r.width,o=r.x,c=t.append("text").attr("x",0).attr("y",Object(s.p)().state.titleShift).attr("font-size",Object(s.p)().state.fontSize).attr("class","state-title").text(e.id),p=c.node().getBBox().width+n;let g,h=Math.max(p,d);h===d&&(h+=n);const l=t.node().getBBox();e.doc,g=o-i,p>d&&(g=(d-h)/2+i),Math.abs(o-l.x)<i&&p>d&&(g=o-(p-d)/2);const b=1-Object(s.p)().state.textHeight;return t.insert("rect",":first-child").attr("x",g).attr("y",b).attr("class",a?"alt-composit":"composit").attr("width",h).attr("height",l.height+Object(s.p)().state.textHeight+Object(s.p)().state.titleShift+1).attr("rx","0"),c.attr("x",g+i),p<=d&&c.attr("x",o+(h-n)/2-p/2+i),t.insert("rect",":first-child").attr("x",g).attr("y",Object(s.p)().state.titleShift-Object(s.p)().state.textHeight-Object(s.p)().state.padding).attr("width",h).attr("height",3*Object(s.p)().state.textHeight).attr("rx",Object(s.p)().state.radius),t.insert("rect",":first-child").attr("x",g).attr("y",Object(s.p)().state.titleShift-Object(s.p)().state.textHeight-Object(s.p)().state.padding).attr("width",h).attr("height",l.height+3+2*Object(s.p)().state.textHeight).attr("rx",Object(s.p)().state.radius),t},h=(t,e)=>{e.attr("class","state-note");const a=e.append("rect").attr("x",0).attr("y",Object(s.p)().state.padding),i=e.append("g"),{textWidth:n,textHeight:r}=((t,e,a,i)=>{let n=0;const r=i.append("text");r.style("text-anchor","start"),r.attr("class","noteText");let d=t.replace(/\r\n/g,"<br/>");const o=(d=d.replace(/\n/g,"<br/>")).split(s.r.lineBreakRegex);let c=1.25*Object(s.p)().state.noteMargin;for(const p of o){const t=p.trim();if(t.length>0){const i=r.append("tspan");i.text(t),0===c&&(c+=i.node().getBBox().height),n+=c,i.attr("x",e+Object(s.p)().state.noteMargin),i.attr("y",a+n+1.25*Object(s.p)().state.noteMargin)}}return{textWidth:r.node().getBBox().width,textHeight:n}})(t,0,0,i);return a.attr("height",r+2*Object(s.p)().state.noteMargin),a.attr("width",n+2*Object(s.p)().state.noteMargin),a},l=function(t,e){const a=e.id,i={id:a,label:e.id,width:0,height:0},n=t.append("g").attr("id",a).attr("class","stateGroup");"start"===e.type&&(t=>t.append("circle").attr("class","start-state").attr("r",Object(s.p)().state.sizeUnit).attr("cx",Object(s.p)().state.padding+Object(s.p)().state.sizeUnit).attr("cy",Object(s.p)().state.padding+Object(s.p)().state.sizeUnit))(n),"end"===e.type&&(t=>(t.append("circle").attr("class","end-state-outer").attr("r",Object(s.p)().state.sizeUnit+Object(s.p)().state.miniPadding).attr("cx",Object(s.p)().state.padding+Object(s.p)().state.sizeUnit+Object(s.p)().state.miniPadding).attr("cy",Object(s.p)().state.padding+Object(s.p)().state.sizeUnit+Object(s.p)().state.miniPadding),t.append("circle").attr("class","end-state-inner").attr("r",Object(s.p)().state.sizeUnit).attr("cx",Object(s.p)().state.padding+Object(s.p)().state.sizeUnit+2).attr("cy",Object(s.p)().state.padding+Object(s.p)().state.sizeUnit+2)))(n),"fork"!==e.type&&"join"!==e.type||((t,e)=>{let a=Object(s.p)().state.forkWidth,i=Object(s.p)().state.forkHeight;if(e.parentId){let t=a;a=i,i=t}t.append("rect").style("stroke","black").style("fill","black").attr("width",a).attr("height",i).attr("x",Object(s.p)().state.padding).attr("y",Object(s.p)().state.padding)})(n,e),"note"===e.type&&h(e.note.text,n),"divider"===e.type&&(t=>t.append("line").style("stroke","grey").style("stroke-dasharray","3").attr("x1",Object(s.p)().state.textHeight).attr("class","divider").attr("x2",2*Object(s.p)().state.textHeight).attr("y1",0).attr("y2",0))(n),"default"===e.type&&0===e.descriptions.length&&((t,e)=>{const a=t.append("text").attr("x",2*Object(s.p)().state.padding).attr("y",Object(s.p)().state.textHeight+2*Object(s.p)().state.padding).attr("font-size",Object(s.p)().state.fontSize).attr("class","state-title").text(e.id),i=a.node().getBBox();t.insert("rect",":first-child").attr("x",Object(s.p)().state.padding).attr("y",Object(s.p)().state.padding).attr("width",i.width+2*Object(s.p)().state.padding).attr("height",i.height+2*Object(s.p)().state.padding).attr("rx",Object(s.p)().state.radius)})(n,e),"default"===e.type&&e.descriptions.length>0&&p(n,e);const r=n.node().getBBox();return i.width=r.width+2*Object(s.p)().state.padding,i.height=r.height+2*Object(s.p)().state.padding,c(a,i),i};let b=0;let x;const O={},j=(t,e,a,o,c,p,h)=>{const f=new d.a({compound:!0,multigraph:!0});let u,y=!0;for(u=0;u<t.length;u++)if("relation"===t[u].stmt){y=!1;break}a?f.setGraph({rankdir:"LR",multigraph:!0,compound:!0,ranker:"tight-tree",ranksep:y?1:x.edgeLengthFactor,nodeSep:y?1:50,isMultiGraph:!0}):f.setGraph({rankdir:"TB",multigraph:!0,compound:!0,ranksep:y?1:x.edgeLengthFactor,nodeSep:y?1:50,ranker:"tight-tree",isMultiGraph:!0}),f.setDefaultEdgeLabel(function(){return{}}),h.db.extract(t);const w=h.db.getStates(),B=h.db.getRelations(),m=Object.keys(w);for(const i of m){const t=w[i];let n;if(a&&(t.parentId=a),t.doc){let a=e.append("g").attr("id",t.id).attr("class","stateGroup");n=j(t.doc,a,t.id,!o,c,p,h);{let e=(a=g(a,t,o)).node().getBBox();n.width=e.width,n.height=e.height+x.padding/2,O[t.id]={y:x.compositTitleSize}}}else n=l(e,t);if(t.note){const a={descriptions:[],id:t.id+"-note",note:t.note,type:"note"},i=l(e,a);"left of"===t.note.position?(f.setNode(n.id+"-note",i),f.setNode(n.id,n)):(f.setNode(n.id,n),f.setNode(n.id+"-note",i)),f.setParent(n.id,n.id+"-group"),f.setParent(n.id+"-note",n.id+"-group")}else f.setNode(n.id,n)}s.y.debug("Count=",f.nodeCount(),f);let k=0;B.forEach(function(t){var e;k++,s.y.debug("Setting edge",t),f.setEdge(t.id1,t.id2,{relation:t,width:(e=t.title,e?e.length*x.fontSizeFactor:1),height:x.labelHeight*s.r.getRows(t.title).length,labelpos:"c"},"id"+k)}),Object(r.a)(f),s.y.debug("Graph after layout",f.nodes());const N=e.node();f.nodes().forEach(function(t){if(void 0!==t&&void 0!==f.node(t)){s.y.warn("Node "+t+": "+JSON.stringify(f.node(t))),c.select("#"+N.id+" #"+t).attr("transform","translate("+(f.node(t).x-f.node(t).width/2)+","+(f.node(t).y+(O[t]?O[t].y:0)-f.node(t).height/2)+" )"),c.select("#"+N.id+" #"+t).attr("data-x-shift",f.node(t).x-f.node(t).width/2),p.querySelectorAll("#"+N.id+" #"+t+" .divider").forEach(t=>{const e=t.parentElement;let a=0,i=0;e&&(e.parentElement&&(a=e.parentElement.getBBox().width),i=parseInt(e.getAttribute("data-x-shift"),10),Number.isNaN(i)&&(i=0)),t.setAttribute("x1",0-i+8),t.setAttribute("x2",a-i-8)})}else s.y.debug("No Node "+t+": "+JSON.stringify(f.node(t)))});let E=N.getBBox();f.edges().forEach(function(t){void 0!==t&&void 0!==f.edge(t)&&(s.y.debug("Edge "+t.v+" -> "+t.w+": "+JSON.stringify(f.edge(t))),function(t,e,a){e.points=e.points.filter(t=>!Number.isNaN(t.y));const r=e.points,d=Object(n.y)().x(function(t){return t.x}).y(function(t){return t.y}).curve(n.d),o=t.append("path").attr("d",d(r)).attr("id","edge"+b).attr("class","transition");let c="";if(Object(s.p)().state.arrowMarkerAbsolute&&(c=(c=(c=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search).replace(/\(/g,"\\(")).replace(/\)/g,"\\)")),o.attr("marker-end","url("+c+"#"+function(t){switch(t){case i.f.relationType.AGGREGATION:return"aggregation";case i.f.relationType.EXTENSION:return"extension";case i.f.relationType.COMPOSITION:return"composition";case i.f.relationType.DEPENDENCY:return"dependency"}}(i.f.relationType.DEPENDENCY)+"End)"),void 0!==a.title){const i=t.append("g").attr("class","stateLabel"),{x:n,y:r}=s.H.calcLabelPosition(e.points),d=s.r.getRows(a.title);let o=0;const c=[];let p=0,g=0;for(let t=0;t<=d.length;t++){const e=i.append("text").attr("text-anchor","middle").text(d[t]).attr("x",n).attr("y",r+o),a=e.node().getBBox();if(p=Math.max(p,a.width),g=Math.min(g,a.x),s.y.info(a.x,n,r+o),0===o){const t=e.node().getBBox();o=t.height,s.y.info("Title height",o,r)}c.push(e)}let h=o*d.length;if(d.length>1){const t=(d.length-1)*o*.5;c.forEach((e,a)=>e.attr("y",r+a*o-t)),h=o*d.length}const l=i.node().getBBox();i.insert("rect",":first-child").attr("class","box").attr("x",n-p/2-Object(s.p)().state.padding/2).attr("y",r-h/2-Object(s.p)().state.padding/2-3.5).attr("width",p+Object(s.p)().state.padding).attr("height",h+Object(s.p)().state.padding),s.y.info(l)}b++}(e,f.edge(t),f.edge(t).relation))}),E=N.getBBox();const H={id:a||"root",label:a||"root",width:0,height:0};return H.width=E.width+2*x.padding,H.height=E.height+2*x.padding,s.y.debug("Doc rendered",H,f),H},f={setConf:function(){},draw:function(t,e,a,i){x=Object(s.p)().state;const r=Object(s.p)().securityLevel;let d;"sandbox"===r&&(d=Object(n.H)("#i"+e));const o="sandbox"===r?Object(n.H)(d.nodes()[0].contentDocument.body):Object(n.H)("body"),c="sandbox"===r?d.nodes()[0].contentDocument:document;s.y.debug("Rendering diagram "+t);const p=o.select("[id='".concat(e,"']"));p.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z");const g=i.db.getRootDoc();j(g,p,void 0,!1,o,c,i);const h=x.padding,l=p.node().getBBox(),b=l.width+2*h,O=l.height+2*h,f=1.75*b;Object(s.v)(p,O,f,x.useMaxWidth),p.attr("viewBox","".concat(l.x-x.padding,"  ").concat(l.y-x.padding," ")+b+" "+O)}},u={parser:i.g,db:i.f,renderer:f,styles:i.h,init:t=>{t.state||(t.state={}),t.state.arrowMarkerAbsolute=t.arrowMarkerAbsolute,i.f.clear()}}}}]);
//# sourceMappingURL=27.965399fc.chunk.js.map